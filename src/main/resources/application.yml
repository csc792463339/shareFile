server:
  port: 80
  servlet:
    context-path: /
  # --- 性能优化配置开始 ---
  undertow:
    # 开启直接缓冲区 (Direct Buffers)，减少堆内内存复制，显著提升大文件 IO 性能
    direct-buffers: true
    # 增大缓冲区大小 (默认较小，改为 64KB 或更大)，减少系统调用频率
    buffer-size: 65536
    threads:
      # IO 线程数，负责非阻塞任务，建议设置为 CPU 核心数
      io: 4
      # 工作线程数，负责阻塞任务，适当调大以应对大文件传输占用时间长的问题
      worker: 256
  # --- 性能优化配置结束 ---

spring:
  # 开启 JDK 21 虚拟线程，极大提升高并发下的 IO 吞吐能力
  threads:
    virtual:
      enabled: true
  servlet:
    multipart:
      max-file-size: 5000MB
      max-request-size: 5000MB
      # 设置文件阈值，超过该大小直接写入磁盘而非内存，减少内存压力
      file-size-threshold: 2MB
  security:
    user:
      name: admin
      password: ${ADMIN_PASSWORD:change-me}
  main:
    web-application-type: servlet

storage:
  path: ${STORAGE_PATH:files}
  max-size: 524288000
  cleanup-interval: 300000