<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>闪电传输</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-light.min.css">
    <link rel="stylesheet" href="/css/style.css?v=3.0">
</head>
<body>

<div class="background-animation">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
</div>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-9 col-xl-8">
            <div class="card border-0 mb-4 animate-fade-in-up">
                <div class="card-header text-center border-0 pb-0 pt-4">
                    <div class="d-inline-flex align-items-center justify-content-center bg-white p-3 rounded-circle shadow-sm mb-3" style="width: 64px; height: 64px;">
                        <i class="fas fa-bolt fa-2x text-primary"></i>
                    </div>
                    <h1 class="h3 fw-bold mb-1 text-dark">FlashShare</h1>
                </div>

                <div class="card-body p-4 p-md-5">
                    <div class="row g-3 mb-5 justify-content-center">
                        <div class="col-6">
                            <button class="btn btn-outline-primary w-100 py-3 active fw-bold border-2" onclick="showShareContent()" id="navShareBtn">
                                <i class="fas fa-cloud-upload-alt me-2"></i>我要分享
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="btn btn-outline-secondary w-100 py-3 fw-bold border-2" onclick="showGetShare()" id="navGetBtn">
                                <i class="fas fa-search me-2"></i>我要接收
                            </button>
                        </div>
                    </div>

                    <div id="shareContentSection" class="animate-fade-in">
                        <ul class="nav nav-tabs mb-4 justify-content-center border-0" id="shareTypeTabs" role="tablist">
                            <li class="nav-item me-2" role="presentation">
                                <button class="nav-link active px-4" id="file-tab" data-bs-toggle="tab"
                                        data-bs-target="#file-share" type="button" role="tab">
                                    <i class="fas fa-file-alt me-2"></i>上传文件
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link px-4" id="text-tab" data-bs-toggle="tab"
                                        data-bs-target="#text-share" type="button" role="tab">
                                    <i class="fas fa-pen-nib me-2"></i>粘贴文本
                                </button>
                            </li>
                        </ul>

                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="file-share" role="tabpanel">
                                <div class="upload-area p-5 mb-4 text-center" id="dropZone">
                                    <div class="mb-3">
                                        <div class="bg-white p-3 rounded-circle d-inline-block shadow-sm">
                                            <i class="fas fa-cloud-upload-alt fa-3x text-primary"></i>
                                        </div>
                                    </div>
                                    <h5 class="fw-bold mb-2">点击或拖拽文件到这里</h5>
                                    <p class="text-muted small mb-4">24小时后自动销毁</p>

                                    <label for="fileInput" class="btn btn-primary px-4 py-2 rounded-pill">
                                        <i class="fas fa-folder-open me-2"></i>选择文件
                                    </label>
                                    <input type="file" id="fileInput" class="d-none">

                                    <div class="mt-4 d-none" id="fileInfo">
                                        <div class="alert alert-light border d-flex align-items-center justify-content-between shadow-sm">
                                            <div class="d-flex align-items-center overflow-hidden">
                                                <i class="fas fa-file-alt fa-2x text-primary me-3"></i>
                                                <div class="text-start text-truncate">
                                                    <div class="fw-bold text-dark" id="fileName">filename.txt</div>
                                                    <div class="text-muted small" id="fileSize">0 KB</div>
                                                </div>
                                            </div>
                                            <i class="fas fa-check-circle text-success fs-4"></i>
                                        </div>
                                    </div>

                                    <div class="progress mt-3 d-none" id="uploadProgress" style="height: 6px;">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                    </div>
                                    <div class="text-end small text-muted mt-1 d-none progress-text">0%</div>
                                </div>

                                <button type="button" class="btn btn-primary w-100 py-3 shadow-lg" id="shareFileBtn" disabled>
                                    <i class="fas fa-paper-plane me-2"></i>立即创建分享
                                </button>
                            </div>

                            <div class="tab-pane fade" id="text-share" role="tabpanel">
                                <div class="mb-3">
                                    <textarea class="form-control font-monospace" id="textContent" rows="8"
                                              placeholder="在此粘贴代码或文本内容..."></textarea>
                                    <div class="d-flex justify-content-between mt-2">
                                        <small class="text-muted">已输入 <span id="charCount">0</span> 字符</small>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="richTextToggle">
                                            <label class="form-check-label small" for="richTextToggle">启用代码高亮/Markdown</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <div class="form-check form-switch mb-2">
                                        <input class="form-check-input" type="checkbox" id="previewToggle">
                                        <label class="form-check-label small" for="previewToggle">实时预览</label>
                                    </div>
                                    <div id="previewPanel" class="d-none border rounded p-3 bg-light">
                                        <div id="previewContent"></div>
                                    </div>
                                </div>

                                <button type="button" class="btn btn-primary w-100 py-3 shadow-lg" id="shareTextBtn">
                                    <i class="fas fa-paper-plane me-2"></i>立即创建分享
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="getShareSection" class="d-none animate-fade-in text-center py-4">
                        <div class="bg-light p-5 rounded-4 mb-4 border border-dashed">
                            <i class="fas fa-search-location fa-4x text-muted mb-4 opacity-50"></i>
                            <h4 class="mb-4 fw-bold">请输入 4-6 位分享码</h4>
                            <div class="row justify-content-center">
                                <div class="col-md-8">
                                    <div class="input-group input-group-lg shadow-sm">
                                        <input type="text" class="form-control border-0" id="shareIdInput"
                                               placeholder="例如: A1B2C3"
                                               style="text-transform: uppercase; letter-spacing: 2px; text-align: center;">
                                        <button class="btn btn-primary px-4" id="getShareBtn">
                                            <i class="fas fa-arrow-right"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <p class="text-muted small mt-3">如果不区分大小写，我们将自动转换</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="/js/utils.js?v=3.0"></script>
<script src="/js/upload.js?v=3.0"></script>
<script src="/js/main.js?v=3.0"></script>
<script>
    // 简单的Tab切换逻辑优化
    function showShareContent() {
        document.getElementById('shareContentSection').classList.remove('d-none');
        document.getElementById('getShareSection').classList.add('d-none');

        document.getElementById('navShareBtn').classList.add('btn-outline-primary', 'active');
        document.getElementById('navShareBtn').classList.remove('btn-outline-secondary');

        document.getElementById('navGetBtn').classList.add('btn-outline-secondary');
        document.getElementById('navGetBtn').classList.remove('btn-outline-primary', 'active');
    }

    function showGetShare() {
        document.getElementById('shareContentSection').classList.add('d-none');
        document.getElementById('getShareSection').classList.remove('d-none');

        document.getElementById('navGetBtn').classList.add('btn-outline-primary', 'active');
        document.getElementById('navGetBtn').classList.remove('btn-outline-secondary');

        document.getElementById('navShareBtn').classList.add('btn-outline-secondary');
        document.getElementById('navShareBtn').classList.remove('btn-outline-primary', 'active');

        // 自动聚焦
        setTimeout(() => document.getElementById('shareIdInput').focus(), 100);
    }

    document.getElementById('getShareBtn').addEventListener('click', function() {
        const shareId = document.getElementById('shareIdInput').value.trim();
        if (shareId) {
            window.location.href = '/view.html?id=' + shareId;
        }
    });

    document.getElementById('shareIdInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') document.getElementById('getShareBtn').click();
    });
</script>
</body>
</html>